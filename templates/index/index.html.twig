{% extends 'base.html.twig' %}

{% block title %}
    {{ 'welcome_title' | trans }}
    {{ parent() }}
{% endblock %}

{% block font %}
    <link href="https://fonts.googleapis.com/css?family=Concert+One" rel="stylesheet">
{% endblock %}

{% block body %}

    <div class="container start-page">
        <div class="bubbles">
            <h1 class="font-weight-bold">{{ app_name }}<span class="text-sky">AAA</span>AAAA<span class="text-sky">A</span>A !</h1>
        </div>
        <h2 class="text-sky font-italic">
            Le cri de sauvetage de la langue algérienne !
        </h2>

        <div class="row text-dark mt-5">
            <div class="col-sm-4">

                {% if app.user is same as(null) %} {# For non users only #}
                <div class="card bg-happy mb-3">
                    <div class="card-header font-weight-bold">{{ app_name }}, keskissik?</div>

                    <div class="card-body">
                        <p>{{ page.description | raw }}</p>
                        <a href="{{ path('index_page', { alias: 'keskissik' }) }}" class="btn btn-primary">En savoir plus</a>
                    </div>
                </div>
                {% endif %}

                <div class="card mb-2">
                    <div class="card-header font-weight-bold">Les plus enigmatiques</div>
                    <div class="card-body">
                        <ul class="pl-3 mb-2">
                            {% for domain in constant('App\\Utils\\ModelUtils::DOMAINS') %}
                            <li>
                                <a href="{{ path('post_index', { 'domain': domain, 'enigmatique': true }) }}">
                                    Les {{ domain | capitalize }}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                        <p>
                            Des membres se posent des questions sur l'origine de certaines
                            tournures de langage ; aidez-les.
                        </p>
                    </div>
                </div>

                <div class="card mb-2">
                    <div class="card-header font-weight-bold">Les plus commentés</div>
                    <div class="card-body">
                        body
                    </div>
                </div>

                <div class="card bg-sky font-weight-bold mb-2">
                    <div class="card-header">Noter {{ app_name }}</div>

                    <div class="card-body">
                        <!-- Rating Stars Box -->
                        <div class="rating-stars text-center">
                            <div class="mb-2">
                                {% set sum = 0 %}
                                {% for rating in ratings %}
                                    {% set sum = sum + rating.rating %}
                                {% endfor %}

                                Note de la communauté: {{ (sum / ratings | length) | round(1) }} / 5
                            </div>
                            <ul id="stars" class="mb-2 {{ has_rated is same as(true) ? 'mb-done' }}">
                                <li class="star" title="Oh ! Pas bien du tout !" data-value="1">
                                    <i class="fa fa-star fa-fw"></i>
                                </li>
                                <li class="star" title="Peut mieux faire." data-value="2">
                                    <i class="fa fa-star fa-fw"></i>
                                </li>
                                <li class="star" title="Intik. Pas mauvais ce truc." data-value="3">
                                    <i class="fa fa-star fa-fw"></i>
                                </li>
                                <li class="star" title="Super ! Bien fait !" data-value="4">
                                    <i class="fa fa-star fa-fw"></i>
                                </li>
                                <li class="star" title="Excellent ! J'adore !" data-value="5">
                                    <i class="fa fa-star fa-fw"></i>
                                </li>
                            </ul>

                            <div class="rating-feedback text-success">
                                {{ has_rated is same as(true) ? 'Déjà noté. Awts Merci.' }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-sm-8">
                <div class="card">
                    <p class="card-header font-weight-bold" id="journal-public">Journal public</p>
                    <div class="card-body">

                        <div class="journal-form mb-4 border-bottom pb-2">
                            {% if app.user %}
                                {{ include('partials/_form.html.twig', {'btn' : {'label': 'label.publish' | trans, 'classes' : 'btn-happy'} }) }}
                            {% else %}
                                <div class="form-group">
                                    <label for="op">Publier un message</label>
                                    <textarea id="op" name="op" disabled="disabled" class="form-control"></textarea>
                                </div>
                                {{ include('partials/_btn-login.html.twig', { 'class' : 'btn-happy' }) }}
                            {% endif %}
                        </div>

                        <div class="journal-feed mt-2">
                            {% if journals | length > 0 %}
                                <ul class="list-unstyled">
                                    {% for journal in journals %}
                                        <li class="media mb-3 p-1 border-bottom">
                                            {%  include 'partials/avatar.html.twig' with {'current_user': journal.user, 'size': 64, 'classes': 'mr-3 rounded' } only %}
                                            <div class="media-body">
                                                <p class="mt-0 mb-1">
                                                    <strong>Par: {{ journal.user.username }}</strong> |
                                                    <span class="text-secondary">Le: {{ journal.createdAt | date }}</span>
                                                </p>
                                                <p>{{ journal.message | nl2br }}</p>
                                            </div>

                                            {% if app.user %}
                                                <button class="js_del-journal btn btn-danger float-right" data-uid="{{ journal.id }}"><i class="fa fa-trash"></i></button>
                                            {% endif %}
                                        </li>
                                    {% endfor %}
                                </ul>
                            {% endif %}
                        </div>

                    </div>
                </div>
            </div>


        </div>
    </div>


{% endblock %}
